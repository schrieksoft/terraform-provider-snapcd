---
page_title: "snapcd_module Resource - snapcd"
subcategory: "Modules"
description: |-
  Manages a Module in Snap CD.
---

# snapcd_module (Resource)

Manages a Module in Snap CD.


## Example Usage

```terraform
data "snapcd_stack" "mystack" {
  name = "mystack"
}

data "snapcd_runner" "myrunner" {
  name = "myrunner"
}

resource "snapcd_namespace" "mynamespace" {
  name     = "mynamespace"
  stack_id = data.snapcd_stack.mystack.id
}

resource "snapcd_module" "mymodule" {
  name                = "mymodule"
  namespace_id        = snapcd_namespace.mynamespace.id
  source_revision     = "main"
  source_url          = "https://github.com/schrieksoft/snapcd-samples.git"
  source_subdirectory = "getting-started/two-module-dag/module2"
  runner_id           = data.snapcd_runner.myrunner.id
  engine              = "OpenTofu"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the Module. Must be unique in combination with `namespace_id`.
- `namespace_id` (String) ID of the Module's parent Namespace.
- `runner_id` (String) ID of the Runner that will receive the instructions when triggering a deployment on this Module.
- `source_revision` (String) Remote revision (e.g. version number, branch, commit or tag) where the source module code is found.
- `source_url` (String) Remote URL where the source module code is found.

### Optional

- `apply_after_hook` (String) Shell script that should be executed after the 'Apply' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `apply_approval_threshold` (Number) The number of Users (or Service Principals) that need to approve before an 'Apply' plan is executed. Setting this will override any default value set on the Module's parent Namespace. If set neither on Module nor on Namespace then a threshold of 0 is used.
- `apply_before_hook` (String) Shell script that should be executed before the 'Apply' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `approval_timeout_minutes` (Number) The number of minutes a Job should remain in the 'WaitingForApproval' in the case of an 'Apply' or 'Destroy' plan that requires approval. After this time elapses the Job will be stopped and any queued Jobs will start. Setting this will override any default value set on the Module's parent Namespace. If set neither on Module nor on Namespace the Jobs will wait for an approval decision indefinitely.
- `auto_migrate_enabled` (Boolean) Setting this to true will add the `-migrate-state` flag whenever `init` is called. Setting this will override any default value set on the Module's parent Namespace.
- `auto_reconfigure_enabled` (Boolean) Setting this to true will add the `-reconfigure` flag whenever `init` is called. Setting this will override any default value set on the Module's parent Namespace.
- `auto_upgrade_enabled` (Boolean) Setting this to true will add the `-upgrade` flag whenever `init` is called. Setting this will override any default value set on the Module's parent Namespace.
- `clean_init_enabled` (Boolean) Setting will remove all .terraform* files and folders (state files, locks, downloaded providers, downloaded modules etc.) and perform a clean init every time the Module is executed. Setting this will override any default value set on the Module's parent Namespace.
- `destroy_after_hook` (String) Shell script that should be executed after the 'Destroy' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `destroy_approval_threshold` (Number) The number of Users (or Service Principals) that need to approve before an 'Destroy' plan is executed. Setting this will override any default value set on the Module's parent Namespace. If set neither on Module nor on Namespace then a threshold of 0 is used.
- `destroy_before_hook` (String) Shell script that should be executed before the 'Destroy' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `engine` (String) Determines which binary will be used during deployment. Must be one of 'OpenTofu' and 'Terraform'. Setting this to 'OpenTofu' will use `tofu`. Setting it to 'Terraform' will use `terraform`. Setting this will override any default value set on the Module's parent Namespace.
- `ignore_namespace_backend_configs` (Boolean) If this is set to true, any Backend Configs that have been set on Namespace level will not be used on this specific Module.
- `ignore_namespace_extra_files` (Boolean) If this is set to true, any Extra Files that have been set on Namespace level will not be used on this specific Module.
- `init_after_hook` (String) Shell script that should be executed after the 'Init' step of any deployment is run.Setting this will override any default value set on the Module's parent Namespace.
- `init_before_hook` (String) Shell script that should be executed before the 'Init' step of any deployment is run.Setting this will override any default value set on the Module's parent Namespace.
- `output_after_hook` (String) Shell script that should be executed after the 'Output' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `output_before_hook` (String) Shell script that should be executed before the 'Output' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `output_secret_store_id` (String) The ID of the Secret Store that will be used to store this Module's outputs. Note that for an 'Output' step to successfully use this Secret Store, it must either be deployed as `is_assigned_to_all_scopes=true`, or assigned via module/namespace/stack assignment. Setting this will override any default value set on the Module's parent Namespace.
- `plan_after_hook` (String) Shell script that should be executed after the 'Plan' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `plan_before_hook` (String) Shell script that should be executed before the 'Plan' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `plan_destroy_after_hook` (String) Shell script that should be executed after the 'Destroy' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `plan_destroy_before_hook` (String) Shell script that should be executed before the 'Destroy' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `runner_instance_name` (String) Name a specific runner instance to select (should unique identify the the instance). Use this if you have enabled multiple instances on your runner, but want all jobs for this Module to go to a specific instance.
- `source_revision_type` (String) How Snap CD should interpret the `source_revision` field. Must be one of 'Default' or 'SemanticVersionRange'. Setting to 'Default' means Snap CD will interpret the revision type based on the source type (for example, for a 'Git' source type it will automatically figure out whether the `source_revision` refers to a branch, tag or commit). Setting to 'SemanticVersionRange' means that Snap CD will resolve the revision to a semantic version line `vX.Y.Z` (alternatively witout the 'v' prefix of that is how your semantic version are tagged, i.e. 'X.Y.Z'). It will take the highest version within the major or minor version range that you specify. For example, specify `v2.20.*` or `v2.*`. You can also specify a specific semantic version here, e.g. `v2.20.7`. In that case the behaviour is the same as with when using 'Default', except that only valid semantic versions are accepted. NOTE that 'SemanticVersionRange' is currently only supported in combination with the 'Git' `source_type`.
- `source_subdirectory` (String) Subdirectory where the source module code is found.
- `source_type` (String) The type of remote module store that the source module code should be retrieved from. Must be one of 'Git' or 'Registry'
- `trigger_on_definition_changed` (Boolean) Defaults to 'true'. If 'true', the Module will automatically be applied when its definition changes. A definition change results from fields on the Module itself, on any of its Inputs (Param or Env Var) or Extra Files being altered. So too changes to its Namespace (including Inputs and Extra Files) or Stack. Note however that Namespace and Stack changes are not notified by default. This behaviour can be changed in `snapcd_namespace` and `snapcd_stack` resource definitions.
- `trigger_on_source_changed` (Boolean) Defaults to 'true'. If 'true', the Module will automatically be applied when the source it is referencing has changed. For example, if tracking a Git branch: a new commit would constitute a change.
- `trigger_on_source_changed_notification` (Boolean) Defaults to 'false'. If 'true', the Module will automatically be applied when the 'api/Hooks/SourceChanged' endpoint is called for this Module. Use this if you want to use external tooling to inform Snap CD that a source has been changed. Consider setting `trigger_on_definition_changed` to 'false' when setting `trigger_on_definition_changed_hook` to 'true'
- `trigger_on_upstream_output_changed` (Boolean) Defaults to 'true'. If 'true', the Module will automatically be applied when any Outputs from other Modules that it references as Inputs (Param or Env Var) have changed.
- `validate_after_hook` (String) Shell script that should be executed after the 'Validate' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `validate_before_hook` (String) Shell script that should be executed before the 'Validate' step of any deployment is run. Setting this will override any default value set on the Module's parent Namespace.
- `wait_for_apply_dependencies` (String) Defaults to 'OnFirstApply'. Controls when the Module should wait for dependencies during apply operations. Valid values are 'Always', 'Never', or 'OnFirstApply'. 'Always' means the Module will always wait for Modules its depends on to reach the 'Applied' state before applying. 'Never' means dependencies are ignored. 'OnFirstApply' means the Module will wait for dependencies only on its first apply.
- `wait_for_destroy_dependencies` (String) Defaults to 'Always'. Controls when the Module should wait for dependencies during destroy operations. Valid values are 'Always' or 'Never'. 'Always' means the Module will always wait Modules that depend on it to reach the 'Destroyed' state before destroying. 'Never' means dependencies are ignored.

### Read-Only

- `id` (String) Unique ID of the Module.

## Import

Import is supported using the following syntax:

```shell
RESOURCE_ID="12345678-90ab-cdef-1234-56789abcdef0"
terraform import snapcd_module.this $RESOURCE_ID
```
